<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Ты пидорас</title>
<style>
  html, body {
    margin: 0;
    padding: 0;
    overflow: hidden;
    background: black;
    width: 100%;
    height: 100%;
    display: flex;
    justify-content: center;
    align-items: center;
    position: relative;
    font-family: sans-serif;
  }
  #button {
    padding: 20px 40px;
    font-size: 24px;
    color: white;
    background: none;
    border: 2px solid white;
    cursor: pointer;
    position: absolute;
    z-index: 10;
  }
  canvas {
    position: absolute;
    top: 0;
    left: 0;
  }
</style>
</head>
<body>
<button id="button">Нажми меня</button>
<canvas id="canvas"></canvas>

<script>
const canvas = document.getElementById('canvas');
const ctx = canvas.getContext('2d');
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

let particles = [];
let heartParticles = [];
let textParticles = [];
let animationFrame;
let showHeart = false;
let showText = false;

class Particle {
  constructor(x, y, color, vx=0, vy=0, size=3, life=100) {
    this.x = x;
    this.y = y;
    this.color = color;
    this.vx = vx;
    this.vy = vy;
    this.size = size;
    this.life = life;
    this.alpha = 1;
  }
  update() {
    this.x += this.vx;
    this.y += this.vy;
    if(this.life>0) this.life -=1;
    this.alpha = Math.max(this.life / 100, 0);
  }
  draw() {
    ctx.globalAlpha = this.alpha;
    ctx.fillStyle = this.color;
    ctx.beginPath();
    ctx.arc(this.x, this.y, this.size, 0, Math.PI*2);
    ctx.fill();
    ctx.globalAlpha = 1;
  }
}

function randomColor() {
  return `hsl(${Math.random()*360}, 100%, 60%)`;
}

function explode(x, y, count=50) {
  for(let i=0; i<count; i++){
    const angle = Math.random() * Math.PI * 2;
    const speed = Math.random() * 5 + 2;
    particles.push(new Particle(
      x, y,
      randomColor(),
      Math.cos(angle)*speed,
      Math.sin(angle)*speed,
      Math.random()*3+2,
      100
    ));
  }
}

function drawHeartShape(cx, cy, scale) {
  const points = [];
  for(let t=0; t<Math.PI*2; t+=0.1){
    const x = 16*Math.pow(Math.sin(t),3);
    const y = 13*Math.cos(t) - 5*Math.cos(2*t) -2*Math.cos(3*t) - Math.cos(4*t);
    points.push({x: cx + x*scale, y: cy - y*scale});
  }
  return points;
}

// создаем частицы текста
function createTextParticles(text, fontSize, cx, cy){
  const tempCanvas = document.createElement('canvas');
  const tempCtx = tempCanvas.getContext('2d');
  tempCanvas.width = canvas.width;
  tempCanvas.height = canvas.height;
  tempCtx.font = `${fontSize}px sans-serif`;
  tempCtx.fillStyle = 'white';
  tempCtx.textAlign = 'center';
  tempCtx.textBaseline = 'middle';
  tempCtx.fillText(text, cx, cy);

  const imageData = tempCtx.getImageData(0,0,tempCanvas.width,tempCanvas.height).data;

  const particlesArr = [];
  for(let y=0; y<tempCanvas.height; y+=6){
    for(let x=0; x<tempCanvas.width; x+=6){
      const alpha = imageData[(y*tempCanvas.width + x)*4+3];
      if(alpha>128){
        particlesArr.push(new Particle(Math.random()*canvas.width, Math.random()*canvas.height, 'white'));
        particlesArr[particlesArr.length-1].tx = x;
        particlesArr[particlesArr.length-1].ty = y;
      }
    }
  }
  return particlesArr;
}

function animate() {
  ctx.clearRect(0,0,canvas.width, canvas.height);

  // обычные частицы
  for(let i=particles.length-1; i>=0; i--){
    const p = particles[i];
    p.update();
    p.draw();
    if(p.life <=0) particles.splice(i,1);
  }

  // частицы сердца
  if(showHeart){
    for(let i=0; i<heartParticles.length; i++){
      const p = heartParticles[i];
      p.x += (p.tx - p.x)*0.1;
      p.y += (p.ty - p.y)*0.1;
      p.draw();
    }
  }

  // частицы текста
  if(showText){
    for(let i=0; i<textParticles.length; i++){
      const p = textParticles[i];
      p.x += (p.tx - p.x)*0.1;
      p.y += (p.ty - p.y)*0.1;
      p.draw();
    }
  }

  animationFrame = requestAnimationFrame(animate);
}

document.getElementById('button').addEventListener('click', () => {
  document.getElementById('button').style.display = 'none';

  let fireworkInterval = setInterval(() => {
    const x = Math.random() * canvas.width;
    const y = Math.random() * canvas.height/2;
    explode(x, y, 50);
  }, 100);

  setTimeout(() => {
    clearInterval(fireworkInterval);

    // сердце
    const points = drawHeartShape(canvas.width/2, canvas.height/2, 15);
    heartParticles = points.map(p => new Particle(
      Math.random()*canvas.width,
      Math.random()*canvas.height,
      randomColor(),
      0,0,3,100
    ));
    for(let i=0;i<heartParticles.length;i++){
      heartParticles[i].tx = points[i].x;
      heartParticles[i].ty = points[i].y;
    }
    showHeart = true;

    // создаем частицы текста через 2 секунды
    setTimeout(()=>{
      textParticles = createTextParticles("Ты чудо", 80, canvas.width/2, canvas.height/2);
      showText = true;
    }, 2000);

  }, 5000);
});

animate();

window.addEventListener('resize', ()=>{
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
});
</script>
</body>
</html>
